{"version":3,"sources":["./src/app/core/core.module.ts","./src/app/core/guards/authentication.guard.ts","./src/app/core/services/application.service.ts","./src/app/core/services/http-request-interceptor.ts","./src/app/core/services/security.service.ts","./src/app/core/services/token.service.ts"],"names":[],"mappings":"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","file":"default~comments-comments-module~movies-movies-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { AuthenticationGuard } from './guards/authentication.guard';\n\nimport { HttpRequestInterceptor } from './services/http-request-interceptor';\n\nimport { SecurityService } from './services/security.service';\nimport { TokenService } from './services/token.service';\nimport { ApplicationService } from './services/application.service';\n\n@NgModule({\n    declarations: [\n    ],\n    imports: [],\n    providers: [\n        AuthenticationGuard,\n        SecurityService,\n        TokenService,\n        ApplicationService,\n        {\n            provide: HTTP_INTERCEPTORS,\n            useClass: HttpRequestInterceptor,\n            multi: true\n        }\n    ],\n    exports: []\n})\n\nexport class CoreModule {\n\n}","import { Injectable } from '@angular/core';\nimport { CanActivate } from '@angular/router';\n\n@Injectable()\nexport class AuthenticationGuard implements CanActivate {\n    constructor() { }\n\n    canActivate() {\n        return true;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { TokenService } from './token.service';\n\n@Injectable()\nexport class ApplicationService {\n\n    public baseUrl: string;\n\n    constructor(private tokenService: TokenService) {\n        this.baseUrl = document.getElementsByTagName('base')[0].href;\n    }\n\n    isLoggedIn() {\n        return this.tokenService.getToken() != null;\n    }\n\n    userEmail() {\n        var token = this.tokenService.getToken();\n\n        if (token != null)\n            return token.email;\n\n        return \"\";\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { HttpRequest, HttpErrorResponse, HttpHandler, HttpEvent, HttpInterceptor } from '@angular/common/http';\nimport { empty, Observable, throwError, of } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { TokenService } from './token.service';\nimport { Token } from './security.models';\n\n@Injectable()\nexport class HttpRequestInterceptor implements HttpInterceptor {\n\n    constructor(\n        private router: Router,\n        private tokenService: TokenService\n    ) { }\n\n    intercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\n        var token: Token = this.tokenService.getToken();\n\n        request = token ? request.clone(\n            {\n                headers: request.headers.set(\"Authorization\", \"Bearer \" + token.value)\n            }\n        ) : request;\n\n        return next.handle(request).pipe(\n            catchError(\n                (error: HttpErrorResponse, caught: Observable<HttpEvent<HttpErrorResponse>>) => {\n\n                    if (error.status === 401) {\n                        this.router.navigate(['/login']);\n                        return of<HttpEvent<HttpErrorResponse>>();\n                    }\n\n                    if (error.status === 403) {\n                        this.router.navigate(['/forbidden']);\n                        return of<HttpEvent<HttpErrorResponse>>();\n                    }\n                    return throwError(error);\n                }\n            )\n        );\n    }\n}\n","import { Injectable, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observer, Observable } from 'rxjs';\n\nimport { Token, RegisterModel, LoginModel } from './security.models';\nimport { TokenService } from './token.service';\nimport { ApplicationService } from './application.service';\n\n@Injectable()\nexport class SecurityService {\n\n    constructor(\n        private httpClient: HttpClient,\n        private tokenService: TokenService,\n        private applicationService: ApplicationService) {\n    }\n\n    register(registerModel: RegisterModel) {\n        return new Observable<Token>((obs: Observer<Token>) => {\n            this.httpClient.post<Token>(`${this.applicationService.baseUrl}Account/Register`, registerModel).subscribe(token => {\n\n                this.tokenService.saveToken(token);\n\n                obs.next(token);\n                obs.complete();\n            });\n        });\n    }\n\n    login(loginModel: LoginModel) {\n        return new Observable<Token>((obs: Observer<Token>) => {\n            this.httpClient.post<Token>(`${this.applicationService.baseUrl}Account/Login`, loginModel).subscribe(token => {\n\n                this.tokenService.saveToken(token);\n\n                obs.next(token);\n                obs.complete();\n            });\n        });\n    }\n\n    logout() {\n        this.tokenService.deleteToken();\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Token } from './security.models';\n\n@Injectable()\nexport class TokenService {\n\n    constructor() { }\n\n    saveToken(token: Token) {\n        localStorage.setItem(\"token\", JSON.stringify(token));\n    }\n\n    getToken(): Token | null {\n        return this.validate(JSON.parse(localStorage.getItem(\"token\") as string));\n    }\n\n    validate(token: Token | null): Token | null {\n        if (token) {\n            if (new Date(token.expiry) > new Date())\n                return token;\n        }\n\n        return null;\n    }\n\n    deleteToken() {\n        localStorage.removeItem(\"token\");\n    }\n}\n"],"sourceRoot":"webpack:///"}